"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}if(document.addEventListener("DOMContentLoaded",(function(){if(document.querySelector(".site-wrap").classList.add("dom-loaded"),$(".bubble_card").length>0&&(document.querySelector(".bubble_card__close").addEventListener("click",(function(e){e.target.closest(".bubble_card").classList.add("is-closed")})),window.addEventListener("scroll",(function(){document.querySelector(".bubble_card").classList.toggle("is-scrolled",window.scrollY>300)}))),$(".filter-toggle").length>0){jcf.replaceAll();var e=document.querySelectorAll(".filter-toggle");window.addEventListener("click",(function(t){t.target.closest(".filter-popup")||e.forEach((function(e,r){e.contains(t.target)||e.classList.remove("is-button-active")}))})),e.forEach((function(e,t){e.addEventListener("click",(function(e){e.preventDefault(),e.target.closest(".filter-toggle").classList.toggle("is-button-active")}))})),document.querySelectorAll(".filter-checbox-item").forEach((function(e,t){e.addEventListener("click",(function(e){var t=e.target.closest(".filter-popup"),r=t.querySelectorAll('input[type="checkbox"]:checked').length,i=t.closest(".filter-title"),n=i.querySelector(".filter-count-selected");r>0?(n.innerHTML=r,i.classList.add("is-active")):(n.innerHTML="",i.classList.remove("is-active"))}))})),document.querySelectorAll(".filter-apply").forEach((function(e,t){e.addEventListener("click",(function(e){e.target.closest(".filter-title").querySelector(".filter-toggle").classList.toggle("is-button-active")}))}))}if($(".popup-with-zoom-anim").magnificPopup({type:"inline",fixedContentPos:!1,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in"}),$("#mmenu").length>0){var t=new MmenuLight(document.querySelector("#mmenu"),"(max-width: 900px)"),r=(t.navigation({}),t.offcanvas({}));document.querySelector("a[href='#mmenu']").addEventListener("click",(function(e){e.preventDefault(),r.open()})),document.querySelector(".btn-close").addEventListener("click",(function(e){e.preventDefault(),r.close()})),t.menu.setAttribute("data-mm-spn-title","Фильтр"),$(".js-mm-filter").dataTabs({event:"click",initOpenTab:!1,state:"accordion",jqMethodOpen:"slideDown",jqMethodClose:"slideUp",onTab:function(e,t,r){}})}})),$("#js-historical__line").length>0){var createElemsTooltip=function(e,t,r){var i=document.createElement("div"),n=i.cloneNode(),o=document.createElement("div"),a=r.getBoundingClientRect(),l="point_"+r.getAttribute("place_number");return o.appendChild(document.createTextNode(r.getAttribute("place_number"))),i.appendChild(o),n.appendChild(i),n.style.width=a.width+10+"px",n.style.height=a.height+10+"px",n.style.left=a.left-t-5+"px",n.style.top=a.top-e-5+"px",o.classList.add("duplicate_point"),i.classList.add("duplicate_point_wrapp"),i.setAttribute("place_name",r.getAttribute("place_name")),i.setAttribute("place_url",r.getAttribute("place_url")),n.classList.add("duplicate_point_el","historical_line_point",l),n.setAttribute("data-point-id",r.getAttribute("place_number")),n},recalcElemsTooltip=function(e,t,r){var i=r.getBoundingClientRect(),n=$("[data-point-id="+r.getAttribute("place_number")+"]");n.css("left",i.left-t-5),n.css("top",i.top-e-5)},mapSizesCheck=function(){return window.innerWidth<640?{h:390,w:987}:window.innerWidth<920?{h:500,w:1267}:{h:$(".historical_line_map").height(),w:$(".historical_line_map").width()}},calcImageSize=function(e,t,r,i){var n=mapSizesCheck(),o=t/100,a=r/(e/100)*(n.w/100),l=i/o*(n.h/100);$(".historical_line_svg").attr({width:a,height:l})},place_preview=function(e){return{place_group:e.cloneNode(!0)}},place_common=function(e,t){return t.place_group.setAttribute("data-place-id",e.getAttribute("data-point-id")),{point:e,preview:t}};document.addEventListener("DOMContentLoaded",(function(){if(calcImageSize(1920,762,1026,762),$(window).on("resize",(function(){calcImageSize(1920,762,1026,762);var e=document.querySelectorAll(".svg_line_point"),t=document.querySelector(".svg_animate"),r=t.getBoundingClientRect().top,i=t.getBoundingClientRect().left;e.forEach((function(e){return recalcElemsTooltip(r,i,e)}))})),$("#js-historical__line").length>0){var e=new Vivus("js-historical__line",{type:"scenario",start:"manual",delay:0,duration:130,onReady:function(e){var t=document.querySelectorAll(".svg_line_point"),r=document.querySelector(".svg_animate"),i=r.getBoundingClientRect().top,n=r.getBoundingClientRect().left;t.forEach((function(e){return r.appendChild(createElemsTooltip(i,n,e))})),tippy(".duplicate_point_wrapp",{animation:"scale-subtle",placement:"right",hideOnClick:!1,interactive:!0,allowHTML:!0,maxWidth:"",content:function(e){return'<a href="/objects/where_visit/Monuments'+e.getAttribute("place_url")+'"><span class="ttip-text">'+e.getAttribute("place_name")+'</span><svg aria-hidden="true" width="20" height="16"> <use xlink:href="#arrow-right4"></use> </svg></a>'}})}},(function(e){}));gsap.registerPlugin(ScrollTrigger),$(window).on("onbeforeunload",(function(){scrollTrigger.clearScrollMemory(),window.history.scrollRestoration="manual"}));var t=[];_toConsumableArray(document.querySelectorAll(".historical_place__group")).forEach((function(e){return t.push(place_preview(e))}));var r=[];_toConsumableArray(document.querySelectorAll(".historical_line_point")).forEach((function(e,i){return r.push(place_common(e,t[i]))})),r.forEach((function(e){var t=e.preview.place_group.getAttribute("data-place-id");null===e.preview.place_group.viewportElement&&("2"===t?(document.getElementById("zoom_viewBox").appendChild(e.preview.place_group),gsap.to(e.preview.place_group,{duration:.7,ease:"expo",scale:0,transformOrigin:"50% 50%"})):(document.getElementById("js-historical__line").prepend(e.preview.place_group),gsap.to(e.preview.place_group,{duration:.7,ease:"expo",scale:0,transformOrigin:"50% 50%"})));e.point.addEventListener("click",(function(t){console.log(e.point.getAttribute("data-point-id"))})),e.point.addEventListener("mouseenter",(function(r){(e.point.classList.add("active-play"),e.preview.place_group.classList.add("place_hovered"),"2"===t)&&document.querySelector(".zoom_container").classList.add("zoom-active");gsap.killTweensOf(e.preview.place_group),gsap.to(e.preview.place_group,{opacity:1,duration:.7,ease:"expo",scale:1,transformOrigin:"50% 50%"})})),e.point.addEventListener("mouseleave",(function(r){(e.point.classList.remove("active-play"),e.preview.place_group.classList.remove("place_hovered"),"2"===t)&&document.querySelector(".zoom_container").classList.remove("zoom-active");gsap.killTweensOf(e.preview.place_group),gsap.to(e.preview.place_group,{opacity:0,duration:.7,ease:"expo",scale:0,transformOrigin:"50% 50%"})}))})),gsap.to("#js-historical__line",{scrollTrigger:{trigger:".historical_line_svg",start:"10% bottom",once:!0,onToggle:function(t){t.trigger.parentNode.classList.add("animation-started"),e.play()}}})}}))}